{"ast":null,"code":"var EventEmitter = require('events').EventEmitter;\nvar inherits = require('util').inherits;\nmodule.exports = Stoplight;\ninherits(Stoplight, EventEmitter);\nfunction Stoplight() {\n  var self = this;\n  EventEmitter.call(self);\n  self.isLocked = true;\n}\nStoplight.prototype.go = function () {\n  var self = this;\n  self.isLocked = false;\n  self.emit('unlock');\n};\nStoplight.prototype.stop = function () {\n  var self = this;\n  self.isLocked = true;\n  self.emit('lock');\n};\nStoplight.prototype.await = function (fn) {\n  var self = this;\n  if (self.isLocked) {\n    self.once('unlock', fn);\n  } else {\n    setTimeout(fn);\n  }\n};","map":null,"metadata":{},"sourceType":"script"}